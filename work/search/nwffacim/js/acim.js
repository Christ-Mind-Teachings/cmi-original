var _ = require("underscore");

module.exports = {
  source: "nwffacim",
  year: [
    {
      book: "2002",
      bid: 3,
      unit: [
        "061202", "073102", "080702", "081402", "082802",
        "090402", "091102", "091802", "092502", "100202",
        "101002", "101702", "102402", "103102", "110702",
        "112102", "120502", "121202", "121902"
      ]
    },
    {
      book: "2003",
      bid: 4,
      unit: [
        "010203", "010903", "011603", "012303", "020603",
        "021303", "022003", "022703", "030603", "031303",
        "032003", "032703", "040303", "041003", "042403",
        "050103", "051103", "051803", "052503", "060103",
        "060803", "061503", "062203", "062903", "070603",
        "071303", "072003", "072703", "080303", "081003",
        "081703", "082403", "083103", "090703", "091403",
        "092103", "092803", "101203", "101903", "102603",
        "110203", "110903", "111603", "112303", "120703",
        "121403", "122103"
      ]
    },
    {
      book: "2004",
      bid: 5,
      unit: [
        "011104", "011804", "012504", "020104", "020804",
        "021504", "022204", "030704", "031404", "032804",
        "040404", "041104", "041804", "042504", "050204",
        "050904", "051604", "052304", "053004", "061304",
        "062004", "062704", "071104", "071804", "072504",
        "080104", "080804", "081504", "082204", "090504",
        "091204", "091904", "092604", "100304", "101004",
        "101704", "102404", "110704", "112104", "112804",
        "120504", "121204", "121904"
      ]
    },
    {
      book: "2005",
      bid: 6,
      unit: [
        "010205", "011605", "012305", "013005", "021305",
        "022005", "030605", "031305", "032705", "040305",
        "041005", "041705", "042405", "050105", "050805",
        "052205", "060505", "061205", "061905", "070305",
        "071005", "071705", "072405", "080705", "081405",
        "082105", "082805", "090405", "091105", "091805",
        "100205", "100905", "101605", "102305", "110605",
        "111305", "112005", "120405", "121105", "121805"
      ]
    },
    {
      book: "2006",
      bid: 7,
      unit: [
        "010806", "011506", "012206", "012906", "021206",
        "022606", "030406", "031106", "031906", "040106",
        "041506", "042906", "050606", "052006", "052706",
        "060306", "061006", "061806", "062406", "070106",
        "071506", "073006", "080506", "081206", "082006",
        "090206", "090906", "092306", "100706", "101406",
        "102106", "102806", "111106", "111806", "120206"
      ]
    },
    {
      book: "2007",
      bid: 8,
      unit: [
        "081807", "082507", "090907", "091607", "092207",
        "100607", "101407", "102707", "110307", "111007",
        "111807", "120807", "121607"
      ]
    },
    {
      book: "2008",
      bid: 9,
      unit: [
        "012008", "012708", "021008", "021708", "022408",
        "030208", "030908", "032508", "033008", "040608",
        "041308", "042008", "050408", "051808", "052508",
        "060108", "060808", "061508", "062208", "070608",
        "071308", "072708", "081708", "083108", "090708",
        "091408", "092108", "100508", "101908", "102608",
        "110208", "110908", "112308"
      ]
    },
    {
      book: "2009",
      bid: 10,
      unit: [
        "010309", "011009", "011709", "012409", "020709",
        "022809", "031409", "032809", "040409", "041209",
        "042509", "050909", "052409", "053109", "060709",
        "061309", "062009", "071109", "071809", "072509",
        "080109", "080809", "082909", "090509", "091209",
        "091909", "092709", "101009", "102409", "103109",
        "111409", "112209", "112809", "120509", "121909"
      ]
    },
    {
      book: "2010",
      bid: 11,
      unit: [
        "010210", "011610", "013010", "020610", "021310",
        "030610", "032010", "032710", "040310", "041010",
        "050110", "051510", "052910", "060510", "061210",
        "061910", "070310", "071010", "071710", "072410",
        "080710", "082810", "090410", "091110", "092510",
        "100210", "100910", "101610", "102310", "110610",
        "111310", "112010", "112710", "120410", "121810"
      ]
    },
    {
      book: "2011",
      bid: 12,
      unit: [
        "010111", "010811", "011511", "012211", "020511",
        "021611", "021911", "031211", "032011", "032611",
        "040311", "040911", "041611", "042311", "043011",
        "050711", "051411", "052211", "060411", "061211",
        "061811", "062611", "070911", "071611", "073011",
        "080611", "082011", "082711", "090311", "091711",
        "092411", "100111", "101511", "102311", "110511",
        "111311", "112611", "120411", "121111", "122011"
      ]
    },
    {
      book: "2012",
      bid: 13,
      unit: [
        "010712", "012212", "020512", "021212", "021812",
        "032412", "033112", "040812", "041512", "042212",
        "042912", "051212", "052012", "060312", "061712",
        "072212", "072912", "080412", "081112", "081812",
        "082712", "090812", "091612", "092312", "093012",
        "100812", "101412", "102112", "110512", "111212"
      ]
    },
    {
      book: "2013",
      bid: 14,
      unit: [
        "042713", "050413", "051113", "052013", "052813",
        "060213", "060913", "062513", "063013", "070713",
        "071413", "072113", "080413", "081113", "082513",
        "090113", "090813", "091513", "092313", "100613",
        "101513", "102013", "102713", "110313", "112413",
        "122213", "123013"
      ]
    },
    {
      book: "2014",
      bid: 15,
      unit: [
        "010614", "011414", "012814", "020914", "022414",
        "030914", "041314", "061614", "062914", "091514"
      ]
    },
    {
      book: "2015",
      bid: 16,
      unit: [
        "041815", "042515", "050315", "050915", "051715",
        "060715", "061415", "062115", "062815", "070515",
        "071315", "072115", "080115", "082315", "091315",
        "100215", "102115", "110115"
      ]
    },
    {
      book: "2016",
      bid: 17,
      unit: [
        "070316", "071616", "080216"
      ]
    },
    {
      book: "2017",
      bid: 18,
      unit: []
    }
  ],
  getYear: function(bid) {
    var i;
    var year = "0000";

   for (i = 0; i < this.year.length; i++) {
     if (this.year[i].bid === bid) {
       year = this.year[i].book;
       break;
     }
   }

   return year;
  },
  getBookId: function(yidx) {
    return this.year[yidx].bid;
  },
  decodeUnitId: function(unitId) {
    var unit = unitId;
    var mm;
    var dd;
    var remainder;

    mm = unitId / 100;
    dd = unitId % 100;

    if (mm < 10) {
      mm = "0" + mm;
    }

    if (dd < 10) {
      dd = "0" + dd;
    }

    return mm + dd;
  },
  getUnitId: function(yidx, uidx) {
    var mm;
    var dd;

    if (this.year[yidx].unit.length === 0) {
      return 0;
    }

    mm = Number.parseInt(this.year[yidx].unit[uidx].substr(0, 2), 10);
    dd = Number.parseInt(this.year[yidx].unit[uidx].substr(2, 2), 10);

    uid = (mm * 100) + dd;
    return uid;
  },
  getBookIndex: function(book) {
    var idx = _.findIndex(this.year, function(item) {
      if (item.book === this.book) {
        return true;
      }
    }, {book: book});

    return idx;
  }
  /*
  calcKey: function(yidx, uidx) {
    //if no uidx arg passed return the key for the book
    if (!uidx) {
      return this.year[yidx].bid * 10000000;
    }

    var uid = this.calcUid(yidx, uidx);
    return (this.year[yidx].bid * 10000000) + (uid * 1000);
  },
  getAlphaOmega(yidx, uidx) {
    var ao = {
      book: this.year[yidx].book,
      bid: this.year[yidx].bid,
      first: 0, last: 0
    };

    //not all years are ready yet
    if (this.year[yidx].unit.length === 0) {
      return ao;
    }

    //return first and last keys for the book
    if (!uidx) {
      ao.first = this.calcKey(yidx);
      ao.last = this.calcKey(yidx, this.year[yidx].unit.length - 1) + 999;
    }
    //return first and last for the unit
    else {
      ao.first = this.calcKey(yidx, this.year[yidx].unit[uidx]);
      ao.last = ao.first + 999;
    }

    return ao;
  },
  */
};

